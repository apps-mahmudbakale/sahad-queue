<!--
Copyright (c) 2020-2022 LG Electronics Inc.

SPDX-License-Identifier: Apache-2.0
-->

<!DOCTYPE html>
<html>
<head>
<title>Sahad Hospitals Queue</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/css/bootstrap.min.css">
<script type="text/javascript">
window.onload = function() {
    var bridge = new WebOSServiceBridge();
    /*
     *  getTimeApi calls gettime of systemservice, a module in the platform.
     */
    var getTimeApi = 'luna://com.webos.service.systemservice/clock/getTime';
    var getTimeParams = '{}';

    /*
     *  helloApi calls the hello method of js_service template provided by CLI.
     *  In this case, the service name is used as default name "com.domain.app.service" is.
     *  If you change this service name, you need to change the service name of the following API.
     *
     *  If you change the name to helloParmas as you want, the contents will be reflected on the screen.
     */
    var helloApi = 'luna://com.domain.app.service/hello';
    var helloParams = '{"name":"webOS"}';

    function getTime_callback(msg){
        var arg = JSON.parse(msg);
        if (arg.returnValue) {
            console.log("[APP_NAME: example web app] GETTIME_SUCCESS UTC : " + arg.utc);
            //webOSSystem.PmLogString(6, "GETTIME_SUCCESS", '{"APP_NAME": "example web app"}', "UTC : " + arg.utc);
        }
        else {
            console.error("[APP_NAME: example web app] GETTIME_FAILED errorText : " + arg.errorText);
            //webOSSystem.PmLogString(3, "GETTIME_FAILED", '{"APP_NAME": "example web app"}', "errorText : " + arg.errorText);
        }
    }

    function hello_callback(msg){
        var arg = JSON.parse(msg);
        if (arg.returnValue) {
            document.getElementById("txt_msg").innerHTML = arg.Response;
            console.log("[APP_NAME: example web app] CALLHELLO_SUCCESS response : " + arg.Response);
            //webOSSystem.PmLogString(6, "CALLHELLO_SUCCESS", '{"APP_NAME": "example web app"}', "response : " + arg.Response);
        }
        else {
            console.error("[APP_NAME: example web app] CALLHELLO_FAILED errorText : " + arg.errorText);
            //webOSSystem.PmLogString(3, "CALLHELLO_FAILED", '{"APP_NAME": "example web app"}', "errorText : " + arg.errorText);
        }
    }

    bridge.onservicecallback = getTime_callback;
    bridge.call(getTimeApi, getTimeParams);
    document.getElementById("txt_msg").onclick = function() {
        bridge.onservicecallback = hello_callback;
        bridge.call(helloApi, helloParams);
    };
}
</script>
</head>
<body>
    <div class="container">
        <div class="card border-success mb-3">
            <div class="top-head">
                 <h1 class="col-md-10 offset-2 text-success"><img src="icon.png" alt="" class="d-inline"> Sahad Hospitals Queue System</h1>
                 <div class="row justify-content-evenly">
                    <div class="col-4">
                      One of two columns
                    </div>
                    <div class="col-4">
                      One of two columns
                    </div>
                  </div>
            </div>
             <div class="card-header">List of  Patients in Queu</div>
          <div class="card-body">
            <div class="row">
              <div class="col-12 col-sm-12 col-lg-12">
               <!--  <h6 class="text-muted">List of  Patients in Queue</h6>  -->
                <ul class="list-group">
                 
                </ul>
              </div>
            </div>
          </div>
        </div>
    </div>
   

   <script>
       fetch('https://dummyjson.com/users/')
         .then((response)=> {
           return response.json();
         })
         .then((data)=>{
            console.log(data.users);
            appendData(data.users);
         })
         .catch((err)=> {
            console.log(err);
         });


         appendData = (patients)=>{
            let tag = '';
            patients.forEach((patient)=>{
                tag +=`
                <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                <div class="flex-column">
                  ${patient.firstName} ${patient.lastName} (${patient.gender} ${patient.age})
                  <p><small>${patient.address.address}</small></p>
                  <span class="badge bg-info badge-pill"> 2 Copies in Stock</span>
                </div>
                <div class="image-parent">
                    <img src="${patient.image}" class="img-fluid img-thumbnail" alt="quixote">
                </div>
                </a>
                `;
            });
            document.querySelector('.list-group').innerHTML = tag;
         }

   </script>
</body>
</html>
